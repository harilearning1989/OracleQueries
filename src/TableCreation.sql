create table Employee(
      id NUMBER GENERATED BY DEFAULT AS IDENTITY,
      First_Name         VARCHAR2(10 BYTE),
      Last_Name          VARCHAR2(10 BYTE),
      Start_Date         DATE,
      End_Date           DATE,
      Salary             Number(8,2),
      City               VARCHAR2(10 BYTE),
      Description        VARCHAR2(15 BYTE)
  ); 
 
 insert into Employee(First_Name, Last_Name, Start_Date,End_Date,Salary,City,Description)
                 values ('Jason','Martin',to_date('19960725','YYYYMMDD'), to_date('20060725','YYYYMMDD'), 1234.56, 'Toronto',  'Programmer');
 insert into Employee(First_Name, Last_Name, Start_Date,End_Date,Salary,City,Description)
                  values('Alison','Mathews', to_date('19760321','YYYYMMDD'), to_date('19860221','YYYYMMDD'), 6661.78, 'Vancouver','Tester');
 insert into Employee(First_Name, Last_Name, Start_Date,End_Date,Salary,  City,Description)
                  values('James','Smith',to_date('19781212','YYYYMMDD'), to_date('19900315','YYYYMMDD'), 6544.78, 'Vancouver','Tester');
 insert into Employee(First_Name, Last_Name, Start_Date,End_Date,Salary,City,Description)
                  values('Celia','Rice',to_date('19821024','YYYYMMDD'), to_date('19990421','YYYYMMDD'), 2344.78, 'Vancouver','Manager');
 insert into Employee(First_Name, Last_Name, Start_Date,End_Date,Salary,City,Description)
                  values('Robert','Black',to_date('19840115','YYYYMMDD'), to_date('19980808','YYYYMMDD'), 2334.78, 'Vancouver','Tester');
 insert into Employee(First_Name, Last_Name, Start_Date,End_Date,Salary, City,Description)
                  values('Linda','Green',to_date('19870730','YYYYMMDD'), to_date('19960104','YYYYMMDD'), 4322.78,'New York',  'Tester');
 insert into Employee(First_Name, Last_Name, Start_Date,End_Date,Salary, City,Description)
                  values('David','Larry',to_date('19901231','YYYYMMDD'), to_date('19980212','YYYYMMDD'), 7897.78,'New York',  'Manager');
 insert into Employee(First_Name, Last_Name, Start_Date,End_Date,Salary, City,Description)
                  values('James','Cat',to_date('19960917','YYYYMMDD'), to_date('20020415','YYYYMMDD'), 1232.78,'Vancouver', 'Tester');
commit;

-------Employee----Complete

--Creating Oracle Object-------------------------------------------------------------------------------

create table employees(last_name varchar2(10),salary number,department_id varchar2(10));
create table locations(location_id varchar2(10),city varchar2(10));
create table departments(department_id varchar2(10),location_id varchar2(10),department_name varchar2(10));

insert into employees values ('ASHISH',6000000,'D1');
insert into employees values ('MAHESH',5000000,'D2');

insert into departments values('D1','L1','IT');
insert into departments values('D2','L2','FINANCE');

insert into locations values('L1','Gurgoan');
insert into locations values('L2','Chennai');

commit;
-----------------------------------------------------------------------------------------------------
create or replace type emp1 as object (lname varchar2(10),city varchar2(10),sal number(10));
/
create or replace type emp3 as table of emp1;
/
CREATE OR REPLACE FUNCTION getashish(dept VARCHAR2) RETURN emp3 AS
  emp5 emp3 := emp3();
  str VARCHAR2(300);
BEGIN
  str := 'select emp1(e.last_name,l.city,e.salary) from employees e join departments d 
on e.department_id = d.department_id join locations l on d.location_id=l.location_id where 
d.department_name = :dept';
  EXECUTE immediate str bulk collect INTO emp5 USING dept;
  RETURN emp5;
END;
/

SELECT * FROM TABLE( CAST(getashish('IT') AS emp3))
UNION
SELECT * FROM TABLE( CAST(getashish('FINANCE') AS emp3));

---------------COmplete the Object---------------------------------------------------------------------
